(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31511,        790]
NotebookOptionsPosition[     28964,        742]
NotebookOutlinePosition[     29580,        763]
CellTagsIndexPosition[     29537,        760]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Arnoldi Iteration", "Title",
 CellChangeTimes->CompressedData["
1:eJwdzGkow2EAx/G/I0ZSlKsmxngh88ILxwtpc2TxQiLyQhKyF46Qe0Lxjtw0
coXmNrzzwmbtb5gQOXKFhc3E5ozC83tefPu8+/JyilPyrBmG4ZGgyFrEbMpN
wvWzMSso4+hjX4hl7ZwE2Pob6mgmslVDTtCYpAuyEOXCG2rS5NjwK7HzcX4E
Olf6+nGnTMLwVzO12TNy2ZtYwmqpXW/i21LiYhyrhwHngwYZMddh3AhFGQrl
ALGh9kcFFerq4FkipyM6BOqYllIVkZ/mUQ7buleVsO5CS13qqZk/Iu5uyxYg
R7e/BlPEZUq4Ymi/hmrLvR7aHlQYoNi11Qglmv2JY2Jo0NkkrGej1ZDbX0M9
j9jcgNreIi3kP6ceQPe5gkOYGCU4hXbmDuoTV3oF7x4U1FTplh5mfWY+QKmk
0QQj8s1P9P8usMA9Dwn18r3nA/IE4Z/wq9DmD2aX99mcEL1mGu1h4EqeE1R5
x7vAtel0N5i1k+wFO5smqPLfGB/4PTVKjdWU+EOWF8aH/xohOcg=
  
  "],ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],

Cell["\<\
The Arnoldi Iteration is an iterative reinterpretation of the procedure to \
generate the Hessenberg decomposition of a general matrix. It is used to \
generate a small Upper Hessenberg matrix H that approximates large \
eigenvalues of a big matrix A \
\>", "Text",
 CellChangeTimes->{{3.8470540488466187`*^9, 3.847054299041844*^9}, 
   3.847054620646575*^9, {3.84705469788529*^9, 3.8470547053171043`*^9}, {
   3.84705474014857*^9, 3.847054741548669*^9}, {3.84705479048367*^9, 
   3.8470548010520067`*^9}, {3.847097256754077*^9, 3.8470972849056597`*^9}, {
   3.847140756236305*^9, 3.847140780380496*^9}, {3.847141112793906*^9, 
   3.847141123081209*^9}, {3.847141212815769*^9, 3.8471414441116858`*^9}, {
   3.847141743880835*^9, 3.847141771661133*^9}, {3.847142998261689*^9, 
   3.847143060799942*^9}, {3.857387683075354*^9, 
   3.857387883804387*^9}},ExpressionUUID->"19c34891-b4a5-4bb2-9167-\
f8ac0b4049d9"],

Cell[CellGroupData[{

Cell["Krylov Subspaces and the Arnoldi Iteration", "Section",
 CellChangeTimes->{{3.857383788378104*^9, 3.857383821648407*^9}, {
   3.857385325684114*^9, 3.857385335116852*^9}, 3.857385847674522*^9, {
   3.857387984524889*^9, 3.8573879933083344`*^9}, {3.857389074871306*^9, 
   3.857389093967098*^9}},ExpressionUUID->"9900026f-b42a-4178-8512-\
5a797ad12d8c"],

Cell[TextData[{
 "The ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3e76944a-4c33-4233-a1a1-d62678f2a0fc"],
 " dimensional Krylov space defined by ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "72137341-92c6-480a-9b39-55faa660d88e"],
 " and ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4e702b25-28d6-49d8-be0b-5bca766b0c18"],
 " is \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalK]", "n"], "(", 
     RowBox[{"A", ",", "b"}], ")"}], ":=", 
    RowBox[{"span", "(", 
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"A", ".", "b"}], ",", 
       RowBox[{
        SuperscriptBox["A", "2"], ".", "b"}], ",", "\[Ellipsis]", ",", 
       RowBox[{
        SuperscriptBox["A", 
         RowBox[{"n", "-", "1"}]], ".", "b"}]}], "}"}], ")"}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "eac726c5-7b9f-4e61-9355-3138b04903c1"],
 "\nThe Arnoldi Iteration below constructs an orthogonal basis (a tall skinny \
orthogonal matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     RowBox[{"m", "\[Times]", "n"}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "73a38cdd-330f-4306-a8dd-25fb1fbd514e"],
 ") for the Krylov space and while building an \
\[OpenCurlyDoubleQuote]expanded\[CloseCurlyDoubleQuote] Upper Hessenberg \
matrix ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "71d440a6-7652-4a0a-bbfa-913ed8fbcbca"],
 " that describes the action of ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "21a22b4b-95b2-42cb-b9f6-a8e7a9425d6f"],
 " on ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "059c5702-759f-4a18-a659-d12cac36930d"],
 ".  "
}], "Text",
 CellChangeTimes->{{3.857383824201223*^9, 3.857383935929935*^9}, {
  3.8573850650448112`*^9, 3.857385069555675*^9}, {3.857385348948452*^9, 
  3.8573854222129793`*^9}, {3.85738800073948*^9, 3.8573880984839687`*^9}, {
  3.857388224313765*^9, 3.8573884887320843`*^9}, {3.857388533099959*^9, 
  3.857388793214662*^9}, {3.857389054602974*^9, 3.857389064057185*^9}, {
  3.8573891974581537`*^9, 3.857389478362156*^9}, {3.857390294393354*^9, 
  3.857390296327623*^9}},ExpressionUUID->"915f2246-2dc7-4d39-b874-\
9feaa4d9beed"],

Cell[TextData[{
 "Arnoldi Iteration\ninput b \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "1"], "=", 
    RowBox[{"b", "/", 
     RowBox[{"norm", "(", "b", ")"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d19e7100-e42f-4074-853b-87744c8348c3"],
 "\nfor n in 1:\[Infinity]\n\tw = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", ".", 
    SubscriptBox["q", "n"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "328383c0-377a-4c43-9004-96fadab5c56d"],
 "\n\tfor k in 1:n\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", 
     RowBox[{"k", ",", "n"}]], "=", 
    RowBox[{
     SubscriptBox["q", "k"], ".", "w"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "df6a1035-0d56-4d29-8325-7734382189c1"],
 "\n\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"w", "=", 
    RowBox[{"w", "-", 
     RowBox[{
      SubscriptBox["H", 
       RowBox[{"k", ",", "n"}]], 
      SubscriptBox["q", "k"]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5d916057-c9a7-472f-a416-0ef55a8482a2"],
 "\n\tend\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", 
     RowBox[{
      RowBox[{"n", "+", "1"}], ",", "n"}]], "=", 
    RowBox[{"norm", "(", "w", ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2bc0dfdd-efb4-4172-807a-0e6405806b7a"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", 
     RowBox[{"n", "+", "1"}]], "=", 
    RowBox[{"w", "/", 
     RowBox[{"norm", "(", "w", ")"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f366047f-5ecb-4ba9-98fd-f8ba8e54796b"],
 "\n\[Ellipsis]"
}], "Program",
 CellChangeTimes->{{3.857389525256377*^9, 
  3.857389814045141*^9}},ExpressionUUID->"f6cba028-6d6c-4017-8b94-\
57c8b579095b"],

Cell[TextData[{
 "This is easy to code.  I am writing this as a single step going from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"n", "\[LongRightArrow]", "n"}], "+", "1"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5c60b784-bd38-4a56-acf3-ab677bd13ad4"],
 ".  "
}], "Text",
 CellChangeTimes->{{3.857389845810317*^9, 3.857389858068243*^9}, {
  3.857389958123708*^9, 
  3.857390253747788*^9}},ExpressionUUID->"142a1057-c932-43fc-b171-\
46ad05152633"],

Cell[CellGroupData[{

Cell[TextData[{
 "The input arguments are A, the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d9f787ed-b73f-4bf5-a47f-63b225623bcd"],
 " orthogonal basis ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "66700d5d-1484-4193-b3f0-e9697dd40bad"],
 ", and the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "+", "1"}], ")"}], "\[Times]", "n"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9a8b7838-7537-4463-ac8b-277f591f35bb"],
 " expanded upper Hessenberg matrix H. "
}], "Item",
 CellChangeTimes->{{3.857389845810317*^9, 3.857389858068243*^9}, {
  3.857389958123708*^9, 
  3.8573903033664083`*^9}},ExpressionUUID->"815cca46-cce1-44b8-93c7-\
e5d5abe03eb6"],

Cell[TextData[{
 "Outputs are the new ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", 
    RowBox[{"(", 
     RowBox[{"n", "+", "1"}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d38fbd2f-426d-41a2-8d45-c3587de2eed8"],
 " orthogonal basis and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "+", "2"}], ")"}], "\[Times]", 
    RowBox[{"(", 
     RowBox[{"n", "+", "1"}], ")"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2b248c60-16f7-4635-acce-8c9dacd263c3"],
 " expanded upper Hessenberg matrix.   "
}], "Item",
 CellChangeTimes->{{3.857389845810317*^9, 3.857389858068243*^9}, {
  3.857389958123708*^9, 3.85739027193565*^9}, {3.8573903103189697`*^9, 
  3.857390401714656*^9}},ExpressionUUID->"3c9eea37-b473-41a6-985e-\
5b74e7e39bb6"]
}, Open  ]],

Cell["\<\
The argument we did to show that the Hessenberg decomposition was uniquely \
defined by the first column of Q might be useful here.  \
\>", "Text",
 CellChangeTimes->{{3.857389845810317*^9, 3.857389858068243*^9}, {
  3.857389958123708*^9, 3.85739027193565*^9}, {3.8573903103189697`*^9, 
  3.857390394341168*^9}, {3.857391159127159*^9, 
  3.857391199814156*^9}},ExpressionUUID->"c40f651a-296a-4851-8496-\
03bdd084b83d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Arnoldi", "[", "A_", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"Q_", ",", "H_"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n", ",", "w", ",", "hCol", ",", "h", ",", "q"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"HNew", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "+", "2"}], ",", 
          RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"A", ".", 
       RowBox[{"Q", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "n"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hCol", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"q", "=", 
          RowBox[{"Q", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"HNew", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", 
            RowBox[{"n", "+", "1"}]}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"q", ".", "w"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"w", "=", 
          RowBox[{"w", "-", 
           RowBox[{
            RowBox[{"HNew", "\[LeftDoubleBracket]", 
             RowBox[{"k", ",", 
              RowBox[{"n", "+", "1"}]}], "\[RightDoubleBracket]"}], " ", 
            "q"}]}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HNew", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"n", "+", "1"}], ",", "n"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Norm", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"w", "/", 
       RowBox[{"Norm", "[", "w", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Q", "\[Transpose]"}], ",", 
          RowBox[{"{", "w", "}"}]}], "]"}], "\[Transpose]"}], ",", "HNew"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.857390419897264*^9, 3.857390514589136*^9}, {
  3.857390545214307*^9, 3.857391031796403*^9}, {3.857391210808942*^9, 
  3.857391211017372*^9}, {3.8573913042032557`*^9, 3.85739139168911*^9}, {
  3.8573915309435797`*^9, 3.857391566045137*^9}, {3.857391725860197*^9, 
  3.85739182033243*^9}, {3.8573918708580017`*^9, 3.857392004383904*^9}, {
  3.857392037843663*^9, 3.857392048633841*^9}, {3.857392117196125*^9, 
  3.857392176674344*^9}, {3.8573922118426657`*^9, 3.857392215040268*^9}, {
  3.857392548614587*^9, 3.8573927123593187`*^9}, {3.857393042653206*^9, 
  3.857393075915707*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"1de5901b-e345-43c8-858c-2ebed672b6ff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"12", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"A", ",", "Q"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "m", ",", "m"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{
    RowBox[{"Orthogonalize", "[", "Q", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", 
     RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"UpperTriangularize", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Map", "[", 
  RowBox[{"Dimensions", ",", 
   RowBox[{"{", 
    RowBox[{"Q", ",", "H"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"QNew", ",", "HNew"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Arnoldi", "[", "A", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"Q", ",", "H"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Dimensions", ",", 
   RowBox[{"{", 
    RowBox[{"QNew", ",", "HNew"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"MatrixPlot", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"QNew", "\[Transpose]"}], ".", "QNew"}], "]"}], ",", "H", ",", 
     "HNew"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.857391036555561*^9, 3.85739114276935*^9}, {
   3.857391218111459*^9, 3.857391272195867*^9}, {3.8573915821532087`*^9, 
   3.8573917059021797`*^9}, {3.857391786312652*^9, 3.857391786560137*^9}, 
   3.857391943314208*^9, {3.857392008042006*^9, 3.857392013465714*^9}, {
   3.85739206931282*^9, 3.85739209687783*^9}, {3.85739240163439*^9, 
   3.857392402298317*^9}, {3.857392443359703*^9, 3.857392451905649*^9}, 
   3.857392599556571*^9, {3.857392972239561*^9, 3.857393032737061*^9}, {
   3.857393196614497*^9, 3.857393256012251*^9}, {3.857393290494272*^9, 
   3.857393291829042*^9}, {3.8573933470235643`*^9, 3.857393347820141*^9}},
 CellLabel->
  "In[338]:=",ExpressionUUID->"a7e59f02-a6dc-4e6f-82e8-d186e4d3c017"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"12", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.857392601578018*^9, 3.8573927188825407`*^9, 3.857392978083891*^9, {
   3.857393011479987*^9, 3.857393033076419*^9}, 3.85739307864926*^9, {
   3.857393205860735*^9, 3.857393256444747*^9}, 3.857393292429021*^9, 
   3.857393348795105*^9},
 CellLabel->
  "Out[342]=",ExpressionUUID->"a9a95038-e49f-4ff9-9a29-7c042baddaee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"12", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.857392601578018*^9, 3.8573927188825407`*^9, 3.857392978083891*^9, {
   3.857393011479987*^9, 3.857393033076419*^9}, 3.85739307864926*^9, {
   3.857393205860735*^9, 3.857393256444747*^9}, 3.857393292429021*^9, 
   3.857393348797608*^9},
 CellLabel->
  "Out[344]=",ExpressionUUID->"c1d1c07b-62e0-4dca-9de5-0dc575c8a778"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    RasterBox[{{{1., 1., 1.}, {0.8951824596350807, 0.5241230417539164, 
     0.0052185720628558745`}}, {{1., 0.42, 0.}, {1., 1., 1.}}}, {{0, 0}, {2, 
     2}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{1.5, 
         FormBox["1", TraditionalForm]}, {0.5, 
         FormBox["2", TraditionalForm]}}, {{1.5, 
         FormBox["1", TraditionalForm]}, {0.5, 
         FormBox["2", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}], ",", 
   GraphicsBox[
    RasterBox[{{{0.9913306979383462, 0.42861186111981125`, 
     0.00043162029356822416`}}, {{0.260487, 0.356, 0.891569}}}, {{0, 0}, {1, 
     2}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{1.5, 
         FormBox["1", TraditionalForm]}, {0.5, 
         FormBox["2", TraditionalForm]}}, {{1.5, 
         FormBox["1", TraditionalForm]}, {0.5, 
         FormBox["2", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}], ",", 
   GraphicsBox[
    RasterBox[{{{1., 1., 1.}, {1., 1., 1.}}, {{1., 0.42, 0.}, {1., 1., 
     1.}}, {{1., 1., 1.}, {0.3906965207757982, 0.6570932805508946, 
     0.7981207099206882}}}, {{0, 0}, {2, 3}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{2.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {0.5, 
         FormBox["3", TraditionalForm]}}, {{2.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {0.5, 
         FormBox["3", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.857392601578018*^9, 3.8573927188825407`*^9, 3.857392978083891*^9, {
   3.857393011479987*^9, 3.857393033076419*^9}, 3.85739307864926*^9, {
   3.857393205860735*^9, 3.857393256444747*^9}, 3.857393292429021*^9, 
   3.857393348840495*^9},
 CellLabel->
  "Out[345]=",ExpressionUUID->"fa4022d8-1256-4b1a-8fbe-78f8f36850cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"QNew", ",", "HNew"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Arnoldi", "[", "A", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"Q", ",", "H"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Dimensions", ",", 
   RowBox[{"{", 
    RowBox[{"Q", ",", "QNew", ",", "H", ",", "HNew"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", "QNew", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.857391036555561*^9, 3.85739114276935*^9}, {
   3.857391218111459*^9, 3.857391272195867*^9}, {3.8573915821532087`*^9, 
   3.8573917059021797`*^9}, {3.857391786312652*^9, 3.857391786560137*^9}, 
   3.857391943314208*^9, {3.857392008042006*^9, 3.857392013465714*^9}, {
   3.85739206931282*^9, 3.85739209687783*^9}, {3.85739240163439*^9, 
   3.857392402298317*^9}, {3.857392443359703*^9, 3.857392451905649*^9}, 
   3.857392599556571*^9},ExpressionUUID->"22673d15-b950-4d44-8419-\
355644fa6966"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"12", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.85739112873241*^9, {3.857391244233778*^9, 3.8573912780802393`*^9}, 
   3.85739131339322*^9, 3.857391348420648*^9, 3.857391399566091*^9, {
   3.857391558112896*^9, 3.857391595766444*^9}, 3.857391789402926*^9, {
   3.8573918235025873`*^9, 3.8573918824249487`*^9}, 3.8573919454353437`*^9, {
   3.857392014024952*^9, 3.857392179305929*^9}, {3.857392387003744*^9, 
   3.857392402748952*^9}, 3.857392453531843*^9},
 CellLabel->
  "Out[243]=",ExpressionUUID->"dba2b093-8816-4c34-b43d-8ce9baaf7890"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.857392164138302*^9, 3.857392179294539*^9}, {
   3.8573923869921637`*^9, 3.8573924026872873`*^9}, 3.857392453533348*^9},
 CellLabel->
  "During evaluation of \
In[239]:=",ExpressionUUID->"4de7f1d3-8185-4c1a-8850-b96586cd2a75"],

Cell[BoxData[
 TemplateBox[{
  "ArrayFlatten", "match", 
   "\"\\!\\(\\*RowBox[{\\\"ArrayFlatten\\\", \\\"[\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\
\", RowBox[{\\\"0.9141423678638922`\\\", \\\",\\\", \\\"0.9301744746271243`\\\
\", \\\",\\\", RowBox[{\\\"-\\\", \\\"0.7297977957998425`\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.2832226170847365`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"0.8806531235580537`\\\"}], \\\",\\\", \\\"0.16086938441483634`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"0.4923232406128428`\\\"}], \\\",\\\", \
\\\"0.19148709778508133`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \\\
\"0.940627038292575`\\\"}]}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\
\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}], \\\"]\\\"}]\\) fails the matching \
condition for ArrayFlatten[a,n]: if b = a[[i_1,i_2,...,i_n]], c = \
a[[j_1,j_2,...,j_n]], Head[a] == Head[b] == Head[c], Length[Dimensions[b]] >= \
n, Length[Dimensions[c]] >= n, and i_k = j_k, then Dimensions[b][[k]] must \
equal Dimensions[c][[k]]. Here the condition fails for k = \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) and i_k = j_k = \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\).\"", 2, 244, 46, 33164712879964850964, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.857392134915056*^9, 3.857392179296762*^9}, {
   3.857392386994405*^9, 3.857392402689592*^9}, 3.857392453534704*^9},
 CellLabel->
  "During evaluation of \
In[239]:=",ExpressionUUID->"df25e272-6a29-45ac-b7d5-c5633a9b28d2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"12", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.85739112873241*^9, {3.857391244233778*^9, 3.8573912780802393`*^9}, 
   3.85739131339322*^9, 3.857391348420648*^9, 3.857391399566091*^9, {
   3.857391558112896*^9, 3.857391595766444*^9}, 3.857391789402926*^9, {
   3.8573918235025873`*^9, 3.8573918824249487`*^9}, 3.8573919454353437`*^9, {
   3.857392014024952*^9, 3.857392179305929*^9}, {3.857392387003744*^9, 
   3.857392402748952*^9}, 3.8573924536046133`*^9},
 CellLabel->
  "Out[245]=",ExpressionUUID->"a30c490e-74da-4805-877a-f309745eb8e3"],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJwVlGtUjAkAhks41soqDNVqmmpdpklOHGm13mFm1WrEcUkbkkirkbLtlu3i
ZNAY0q7bpDa3Me6H2Q1F7RI2dNJUapqpMM1V37VQG+my7Y/nnOf99/x6eXHJ
q+KdHBwcxg0zcpj/PXFS74b6B/VYn5P9Nr6/HQN3zYW6RhKnb8TKw1aboB9K
zyp88gbCybQnyaWgOrm+OiKfRl+4x2BnrB3iz7bcduS9QNV1Tl/uNRq3HcPC
ol7aUWxdFRA3ugkNtYT7cmcWH/12yvRJNOTTtvn/+c6OxvcJUqWCRV+US0+W
iIXZg1obdpdCypnpwcLHDG4oNF+u07IoISh12vJONO/NydCdpzBVxHmkjTRj
d1deoy9zHg/YssyIUAJjlhSVpH1LQ9aZkNpSwyBWtL0qf3MDsn/oqDkWboKa
7Rb9Xk7Cp0A+Ofn9S9zz7feez7fDy9sYoueTUD3Ycuf1AgbMwrM1jcsITPf2
OqNRvsIJv0T3lDgWCzjH5x7RMLj0b6gqK4iE57juo64SEiF+hgsvDTRcW0b1
7PJhIfn+pIvfAAVtat3mYLsFkm8yFYEPK/HPULDPFeUL/D1Rl2gym0A/9PCM
P0RiDK9Yax3urXThTtOkUZC2lC6oT7aicAcnl2disGhfrEvnEwp05PyGPKEN
whzf8ndjbUiR2ZPk7QQK985ZcWoTDa5eEtAroSHeNzBljsiGOy3U6JCMGrSl
j5Ep4ptQ9UeSa3qVGRfGnT8WuISE91jJ2fnDW552sPNWQQecFBf5s4sp7ODO
vWToZlC2N7JtpwsNvnh2wJoRdiRMakkVrDTi7VJrpJfOjtbVn6dt/41ExPhl
OR1mPQTOdVlPM6xw2hb9rLWUwIi7X/doJuhQ1lakWeRmgbD+ozpnBondTe/d
ZI8tKO8tzNg1g8DV2TfnFL2l8EHjdfmvFwbInqYd8O+yQu25/9cfjxIYuSNC
KN7YiC1NK7nuYjOyVjvfT5SS2D8wao80j0FBFMnT5ZLYE+cQ2zVkwmVJpOzq
6GaY+74iLx21gPo0z8nHkQSfK7vWcL0ecROigm8/a0bbRN/SCjkN8pH31Ozp
LM7J1tSOrKVx0LwxYTH5Bs/9Y9YpDLVw/dB3xDLFCM6o/dTCUAobquuvT+Dr
seh5Une4lxXfJdf+rGkk0J/7JJtawWBrpqEnSEWAW1hdqow2gp8edN/HXQth
UJJHf+ZrcNwuRtyLoWAo6XUMKWOQW2FzOzOTwrlkbuZDtQW/iH1U0ko7prk6
yOv0JIwHAlV572gg3feELZCG6NCtm+FBJuQZYszRwbuh3JpgVKppOIt1H5YL
WEgdYxb7MSxG8KLKxvc3IGDqFOPcAhOGBFf9ZSoSxaFPpRUXGERrU7fRr0lw
Aor4rjYzrq0NFdqLmjHYfnpeUOtwh8D8yYkkhn9BffxGAoMBj+pTg58ICDiD
gjplO67YNieWpLTC31lUmf+TDXsUYQst9wmUFt3kvVrKYsVh7az1oQweC8Sz
0mcS2LQhq2bVpA70VWxiuwoo5Fu/kJVvZfAfeKVSHw==
   "], {{0, 0}, {4, 12}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{11.5, 
       FormBox["1", TraditionalForm]}, {7.5, 
       FormBox["5", TraditionalForm]}, {0.5, 
       FormBox["12", TraditionalForm]}}, {{11.5, 
       FormBox["1", TraditionalForm]}, {7.5, 
       FormBox["5", TraditionalForm]}, {0.5, 
       FormBox["12", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.85739112873241*^9, {3.857391244233778*^9, 3.8573912780802393`*^9}, 
   3.85739131339322*^9, 3.857391348420648*^9, 3.857391399566091*^9, {
   3.857391558112896*^9, 3.857391595766444*^9}, 3.857391789402926*^9, {
   3.8573918235025873`*^9, 3.8573918824249487`*^9}, 3.8573919454353437`*^9, {
   3.857392014024952*^9, 3.857392179305929*^9}, {3.857392387003744*^9, 
   3.857392402748952*^9}, 3.857392453635867*^9},
 CellLabel->
  "Out[246]=",ExpressionUUID->"0f318558-a77b-4a03-83b3-14c3a3f79931"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1268, 965},
WindowMargins->{{Automatic, -1396}, {Automatic, -109}},
TaggingRules-><|
 "PresenterSettings" -> <|"Dialogs" -> {}|>, "TryRealOnly" -> False|>,
Magnification:>1.5 Inherited,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Aqua.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"70fe1370-9f92-4244-ad3a-a95b0f433dbc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 676, 12, 184, "Title",ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],
Cell[1259, 36, 919, 15, 118, "Text",ExpressionUUID->"19c34891-b4a5-4bb2-9167-f8ac0b4049d9"],
Cell[CellGroupData[{
Cell[2203, 55, 358, 5, 97, "Section",ExpressionUUID->"9900026f-b42a-4178-8512-5a797ad12d8c"],
Cell[2564, 62, 2557, 70, 157, "Text",ExpressionUUID->"915f2246-2dc7-4d39-b874-9feaa4d9beed"],
Cell[5124, 134, 1837, 62, 356, "Program",ExpressionUUID->"f6cba028-6d6c-4017-8b94-57c8b579095b"],
Cell[6964, 198, 487, 13, 52, "Text",ExpressionUUID->"142a1057-c932-43fc-b171-46ad05152633"],
Cell[CellGroupData[{
Cell[7476, 215, 849, 25, 48, "Item",ExpressionUUID->"815cca46-cce1-44b8-93c7-e5d5abe03eb6"],
Cell[8328, 242, 835, 24, 48, "Item",ExpressionUUID->"3c9eea37-b473-41a6-985e-5b74e7e39bb6"]
}, Open  ]],
Cell[9178, 269, 428, 8, 85, "Text",ExpressionUUID->"c40f651a-296a-4851-8496-03bdd084b83d"],
Cell[9609, 279, 3205, 78, 436, "Input",ExpressionUUID->"1de5901b-e345-43c8-858c-2ebed672b6ff"],
Cell[CellGroupData[{
Cell[12839, 361, 2616, 73, 281, "Input",ExpressionUUID->"a7e59f02-a6dc-4e6f-82e8-d186e4d3c017"],
Cell[15458, 436, 515, 13, 69, "Output",ExpressionUUID->"a9a95038-e49f-4ff9-9a29-7c042baddaee"],
Cell[15976, 451, 515, 13, 69, "Output",ExpressionUUID->"c1d1c07b-62e0-4dca-9de5-0dc575c8a778"],
Cell[16494, 466, 4154, 93, 386, "Output",ExpressionUUID->"fa4022d8-1256-4b1a-8fbe-78f8f36850cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20685, 564, 1010, 22, 140, "Input",ExpressionUUID->"22673d15-b950-4d44-8419-355644fa6966"],
Cell[21698, 588, 688, 15, 69, "Output",ExpressionUUID->"dba2b093-8816-4c34-b43d-8ce9baaf7890"],
Cell[22389, 605, 418, 11, 36, "Print",ExpressionUUID->"4de7f1d3-8185-4c1a-8850-b96586cd2a75"],
Cell[22810, 618, 1848, 30, 224, "Message",ExpressionUUID->"df25e272-6a29-45ac-b7d5-c5633a9b28d2"],
Cell[24661, 650, 784, 18, 69, "Output",ExpressionUUID->"a30c490e-74da-4805-877a-f309745eb8e3"],
Cell[25448, 670, 3476, 67, 691, "Output",ExpressionUUID->"0f318558-a77b-4a03-83b3-14c3a3f79931"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

