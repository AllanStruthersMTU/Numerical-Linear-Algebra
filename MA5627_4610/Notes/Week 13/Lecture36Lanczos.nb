(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32596,        873]
NotebookOptionsPosition[     30615,        833]
NotebookOutlinePosition[     31249,        854]
CellTagsIndexPosition[     31206,        851]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["36: Lanczos Iteration", "Title",
 CellChangeTimes->CompressedData["
1:eJwdzEFIk2EAh/EvjVwiQUFNYaLLJSGuww7NhJCtKQ53iLEwOoyQjHZoiUrq
cpKR0WWyWdNYUmu0Ma3M1cCDhN8cfs2a6FCs0Ax16DY3bFvLUNDe/3t4+N0e
YcMddWMWwzAiEpRnyZlpd1w2ueQ4BG28sOI3scXMq4WmfUluksi1v8iDMVWw
LEV0y9aoKpfjZZrYtzVih8faik8LhuIyaTpJ7cm/8LGQ2MQFqE/+KNebiaPV
XBieWR6M2og3jr6OQflVD/uceP/eng96/B3lb4k8S9U5GGQeNfuIoiv8Vtj7
dJyFnT8D1A9Ww8gicfar7T3kBUMTUK1sYaE3al6F/tRmGB6evxuFyhOmGNRN
hZzfiJKyJRfs4qr8UPDMQF2umP4MA/36ABRta+bhqXe3FmDdRfEPeCRpoSYE
xl9wI+KhaoxfwlC7cy0CjbruOKy4mUzQf0acgnN8HXUlY/0LhWLpDvx3O/sA
Xm8dyP5OLHjTnQNLvY150FdYcxxODNefhNqZywWw74GT6t6/VAR3h15RFVNN
JZATnhdBr117Fj6sDFEFJWw5/NSgl8Ax+2A0h43LHI8nqf8BeWFUlw==
  "],ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],

Cell[TextData[{
 "Arnoldi and all sorts of other stuff gets simpler for symmetric matrices. \
As you would expect Upper Hessenberg matrices become tridiagonal.  One other \
thing that happens is the general Arnoldi Iteration gets called Lanczos in \
the special symmetric case. Just as a reminder the Krylov space is \t\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalK]", "n"], "(", 
     RowBox[{"A", ",", "b"}], ")"}], ":=", 
    RowBox[{"span", "(", 
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"A", ".", "b"}], ",", 
       RowBox[{
        SuperscriptBox["A", "2"], ".", "b"}], ",", "\[Ellipsis]", ",", 
       RowBox[{
        SuperscriptBox["A", 
         RowBox[{"n", "-", "1"}]], ".", "b"}]}], "}"}], ")"}]}], 
   TraditionalForm]],ExpressionUUID->"c91ce224-9c68-4acb-95d9-c3c5a261b80f"],
 "\nand Arnoldi iteratively computes a nested sequence of orthonormal basis \
for the Krylov space (represented by orthogonal matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Q", "n"], "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     RowBox[{"m", "\[Times]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "7df52d0e-632c-46e4-af4f-bf41327060c7"],
 ") and a rectangular Upper Hessenberg matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", "n"], "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}], "\[Times]", "n"}]]}], 
   TraditionalForm]],ExpressionUUID->"cbe7a7ff-b185-46ba-a9cf-365b9e6c061c"],
 " which represents the action of A on these basis through\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", ".", 
     SubscriptBox["Q", "n"]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["Q", 
       RowBox[{"n", "+", "1"}]], ".", 
      SubscriptBox["H", "n"]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["Q", "n"], ".", 
       RowBox[{
        SubscriptBox["H", "n"], "[", 
        RowBox[{
         RowBox[{"1", ":", "n"}], ",", 
         RowBox[{"1", ":", "n"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        SubscriptBox["H", "n"], "[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ",", "n"}], "]"}], " ", 
       SubscriptBox["q", 
        RowBox[{"n", "+", "1"}]]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "3da0ee12-817f-43a6-83ed-0b3fdb37f664"],
 ". \nThe question is what simplifies when A is real symmetric.  We are going \
to look at the Arnoldi code and work out what can be tidied up. "
}], "Text",
 CellChangeTimes->{{3.8470540488466187`*^9, 3.847054299041844*^9}, 
   3.847054620646575*^9, {3.84705469788529*^9, 3.8470547053171043`*^9}, {
   3.84705474014857*^9, 3.847054741548669*^9}, {3.84705479048367*^9, 
   3.8470548010520067`*^9}, {3.847097256754077*^9, 3.8470972849056597`*^9}, {
   3.847140756236305*^9, 3.847140780380496*^9}, {3.847141112793906*^9, 
   3.847141123081209*^9}, {3.847141212815769*^9, 3.8471414441116858`*^9}, {
   3.847141743880835*^9, 3.847141771661133*^9}, {3.847142998261689*^9, 
   3.847143060799942*^9}, {3.8587758902452593`*^9, 3.858776033873631*^9}, {
   3.8587760880076685`*^9, 3.85877631985137*^9}, {3.8587763658496523`*^9, 
   3.8587763898274508`*^9}, {3.85877663748153*^9, 
   3.8587766485889173`*^9}},ExpressionUUID->"19c34891-b4a5-4bb2-9167-\
f8ac0b4049d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Arnoldi", "[", "A_", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"Q_", ",", "H_"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n", ",", "HNew", ",", "w", ",", "h", ",", "q"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"HNew", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"HNew", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", "n"}], ",", 
        RowBox[{"1", ";;", 
         RowBox[{"n", "-", "1"}]}]}], "\[RightDoubleBracket]"}], "=", "H"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"A", ".", 
       RowBox[{"Q", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "n"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"q", "=", 
         RowBox[{"Q", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"HNew", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", "n"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"q", ".", "w"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"w", "=", 
         RowBox[{"w", "-", 
          RowBox[{
           RowBox[{"HNew", "\[LeftDoubleBracket]", 
            RowBox[{"k", ",", "n"}], "\[RightDoubleBracket]"}], " ", 
           "q"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HNew", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"n", "+", "1"}], ",", "n"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Norm", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"w", "/", 
       RowBox[{"HNew", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ",", "n"}], "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"Q", 
            RowBox[{
             RowBox[{"{", "w", "}"}], "\[Transpose]"}]}
          }], "\[NoBreak]", ")"}], "]"}], ",", "HNew"}], "\[NoBreak]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQnbytJit57xtHk1tBZSB61m21KhCtVPNzG4i+9Sjy
LIgO6EsA00KNbDdBtAHvt8cg+pxh3FcQfbjw4E8QvadtN28KkHZZ3CUJog+U
3JYH0R89egxAtNf/XSYgOtdDxAxEr3BbZgeiraaIuoFoue9VXiD6gedDML1p
1eQSEN1Vz90JogWeh2wC0ZW+tdtA9NGT7r/B5jBv+guixeb31acD6e7DBo0g
mudu6EYQfcIhYTuILlfM3g2iT5X7nwXRJRWZF0H0jIp7l0D0xrcLb4DoMpEr
t0B019mlL0G0ZkfBBxCt84T9O4i+tFv1B9jc2sp/ILq/JogjA0gDADiJu8U=

  "],
 CellLabel->"In[1]:=",ExpressionUUID->"b267116a-5d29-48b4-b646-4a795f6fcaa2"],

Cell["\<\
Not surprisingly the Hessenberg matrix becomes symmetric tridiagonal. \
\>", "Text",
 CellChangeTimes->{{3.8587769172069907`*^9, 3.85877696217264*^9}, {
  3.8587804306018143`*^9, 
  3.85878046291301*^9}},ExpressionUUID->"435fdbdf-1deb-42e6-9789-\
c9418d7804ac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "123"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"A", "=", " ", 
   RowBox[{"A", " ", "+", " ", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Normalize", "[", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q0", ",", "H0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "b", "}"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "}"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q1", ",", "H1"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Arnoldi", "[", "A", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"Q0", ",", "H0"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q2", ",", "H2"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Arnoldi", "[", "A", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"Q1", ",", "H1"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q3", ",", "H3"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Arnoldi", "[", "A", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"Q2", ",", "H2"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q4", ",", "H4"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Arnoldi", "[", "A", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"Q3", ",", "H3"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", 
  RowBox[{
   RowBox[{"Chop", "[", "H4", "]"}], ",", 
   RowBox[{"ColorRules", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", "->", "Green"}], "}"}]}], ",", 
   RowBox[{"Mesh", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8587766536233735`*^9, 3.8587768996943035`*^9}, {
  3.858782958156375*^9, 3.8587829607528877`*^9}, {3.8588520672623663`*^9, 
  3.858852079352149*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"28cc6474-5dba-4e82-8bd5-5dc18691de07"],

Cell[BoxData[
 GraphicsBox[{RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBWIWIAaxUcEHewwhIsUVJPIYHhW8sZ/0rjhtx88H9mXR
PCah68rscanHJS7splfBeuW1vWnmx4UeRo/tJ0SLilQXb7PX3veTV5fxnf2F
XZck2Rze2Mu8zf/ZXP0Mp/k137murC57a7/hgbxt6Ov79nZ3tveyaBXYy97b
X/Yh44X9jDN3TI8ef22v0ybEod741r4kMKjese+1vdC95j0GjI/sHTLf3zw+
p9ceZu7DKpF17g9vwc1ffGv7X/V9b+3XFdX9OOr02v5l8EnmUy8e25ffOvJp
lt47+z9Kyr+e1d6zr6n/I7lZOx2nO+Wb/83bLPrUflV0ROPsZy/tT8Qu4TVN
fmPPKuv2UMDjvf1UC8GPW/3u2DMUPWNaExBEcngCAPPpiPU=
    "], {{0, 0}, {4, 5}}, {0, 1}], {
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 5}, {4, 5}}, {{0, 4}, {4, 4}}, {{0, 3}, {4, 3}}, {{0, 
       2}, {4, 2}}, {{0, 1}, {4, 1}}, {{0, 0}, {4, 0}}}],
      Antialiasing->False]}, 
    {GrayLevel[
      NCache[-1 + GoldenRatio, 0.6180339887498949]], 
     StyleBox[
      LineBox[{{{0, 0}, {0, 5}}, {{1, 0}, {1, 5}}, {{2, 0}, {2, 5}}, {{3, 
       0}, {3, 5}}, {{4, 0}, {4, 5}}}],
      Antialiasing->False]}}},
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{4.5, 
       FormBox["1", TraditionalForm]}, {3.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {1.5, 
       FormBox["4", TraditionalForm]}, {0.5, 
       FormBox["5", TraditionalForm]}}, {{4.5, 
       FormBox["1", TraditionalForm]}, {3.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {1.5, 
       FormBox["4", TraditionalForm]}, {0.5, 
       FormBox["5", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.858776818643198*^9, {3.858776848934338*^9, 3.8587769002934885`*^9}, 
   3.858782961482633*^9, {3.858852074446543*^9, 3.85885207992998*^9}},
 CellLabel->"Out[19]=",ExpressionUUID->"c237c187-fb66-443d-b853-5e6a8a6cd84a"]
}, Open  ]],

Cell[TextData[{
 "A glance at the code explains this simplification. By construction ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", ".", 
     SubscriptBox["q", "j"]}], "\[Element]", 
    RowBox[{"Span", "(", 
     RowBox[{
      SubscriptBox["q", "1"], ",", 
      SubscriptBox["q", "2"], ",", 
      RowBox[{".", "\[Ellipsis]"}], ",", 
      SubscriptBox["q", "j"], ",", 
      SubscriptBox["q", 
       RowBox[{"j", "+", "1"}]]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "043a1713-b309-4b59-af2d-190761c69e64"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["q", "i"], ".", 
     SubscriptBox["q", "j"]}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "793620ad-40d6-4cef-b1c0-b45cbfad4582"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", "\[NotEqual]", "j"}], TraditionalForm]],ExpressionUUID->
  "61de8ec5-d0c3-4c94-bc8f-dc390d35b15a"],
 " with (again by construction) ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", 
     RowBox[{"i", ",", "j"}]], "=", 
    RowBox[{
     SubscriptBox["q", "j"], ".", "A", ".", 
     SubscriptBox["q", "i"], " ", "."}]}], TraditionalForm]],ExpressionUUID->
  "2f92f0c7-5172-4621-b489-93883d7b2a84"],
 " This means ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", 
     RowBox[{"i", ",", "j"}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "i"], ".", "A", ".", 
      SubscriptBox["q", "j"]}], "=", "0"}]}], TraditionalForm]],
  ExpressionUUID->"879ac59e-10f4-48ed-9e3b-39b0c70314b2"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"i", ">", 
    RowBox[{"j", "+", "1"}]}], TraditionalForm]],ExpressionUUID->
  "5643f8e7-faa0-4846-9245-84da8f4096d8"],
 ". If ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "9666db91-4706-48b3-a189-233dc43fd5f2"],
 " is real symmetric i.e ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"A", "\[Transpose]"}]}], TraditionalForm]],ExpressionUUID->
  "f5a3b3c8-576e-4f6e-a3d5-a92726387acb"],
 " then \n\t  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", 
     RowBox[{"i", ",", "j"}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "i"], ".", "A", ".", 
      SubscriptBox["q", "j"]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "j"], ".", 
       RowBox[{"A", "\[Transpose]"}], ".", 
       SubscriptBox["q", "j"]}], "=", 
      RowBox[{
       RowBox[{
        SubscriptBox["q", "j"], ".", "A", ".", 
        SubscriptBox["q", "j"]}], "=", 
       SubscriptBox["H", 
        RowBox[{"j", ",", "i"}]]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "f59f7b74-12eb-4ae5-a8b7-6f063dd51099"],
 ".\nSo elements of ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]],ExpressionUUID->
  "bf8a9c98-adc2-4983-955f-cad56a594974"],
 " more than one off the diagonal are zero while the sub and super diagonals \
match.  The Lanczos iteration incorporates this simplification and stores the \
diagonal entries ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Alpha]", "n"], TraditionalForm]],ExpressionUUID->
  "633961b5-d104-46b1-895a-7aed253e7dfa"],
 " and off-diagonal entries ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Beta]", "n"], TraditionalForm]],ExpressionUUID->
  "526e4a0e-2014-4b12-a7db-f338d529d855"],
 " in vectors.  "
}], "Text",
 CellChangeTimes->{{3.858780475082552*^9, 3.8587805216852026`*^9}, {
  3.8587805770857983`*^9, 3.8587809930413637`*^9}, {3.8587810283976693`*^9, 
  3.8587813818557887`*^9}, {3.8587814123523207`*^9, 3.858781965926357*^9}, {
  3.858781996132246*^9, 
  3.8587820948029757`*^9}},ExpressionUUID->"0e04644a-c9bf-4e39-b199-\
72604c38e6f9"],

Cell["\<\
Working directly from Algorithm 36.1 I get the following as a script.\
\>", "Text",
 CellChangeTimes->{{3.85885299063507*^9, 3.8588530030221868`*^9}, {
  3.858853215931553*^9, 3.8588532396636286`*^9}, {3.858853494033394*^9, 
  3.858853515351966*^9}},ExpressionUUID->"1243cfa9-51ec-48bb-8ad8-\
eafb9c5c705f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
   RowBox[{"A", "=", 
    RowBox[{"A", "+", 
     RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Initialization", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{"Normalize", "[", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q0", "=", 
    RowBox[{"0", "*", "q1"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"n", "=", "1"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"A", ".", "q1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]1", "=", 
   RowBox[{"q1", ".", "v"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", " ", "=", " ", 
   RowBox[{"v", " ", "-", " ", 
    RowBox[{"\[Beta]0", " ", "q0"}], " ", "-", " ", 
    RowBox[{"\[Alpha]1", " ", "q1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]1", "=", 
   RowBox[{"Norm", "[", "v", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q2", "=", 
    RowBox[{"v", "/", "\[Beta]1"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"n", "=", "2"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{"A", ".", "q2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]2", "=", 
   RowBox[{"q2", ".", "v"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", " ", "=", " ", 
   RowBox[{"v", " ", "-", " ", 
    RowBox[{"\[Beta]1", " ", "q1"}], " ", "-", " ", 
    RowBox[{"\[Alpha]2", " ", "q2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]2", "=", 
   RowBox[{"Norm", "[", "v", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q3", "=", 
   RowBox[{"v", "/", "\[Beta]2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.858782359242996*^9, 3.858782655460885*^9}, {
   3.858782694669466*^9, 3.858782844540738*^9}, {3.8587829099782476`*^9, 
   3.85878294583013*^9}, {3.8587830227816586`*^9, 3.8587830878849726`*^9}, 
   3.858783163207555*^9, {3.8587832204891863`*^9, 3.858783263039551*^9}, {
   3.8587834526900473`*^9, 3.858783642115553*^9}, {3.8588521665528564`*^9, 
   3.8588522637240877`*^9}, {3.8588529814525323`*^9, 
   3.8588529816893873`*^9}, {3.858853126701039*^9, 3.8588532127418256`*^9}, {
   3.858853245987753*^9, 3.8588533597233524`*^9}, {3.8588533976183033`*^9, 
   3.8588534670832415`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"4cdbf6aa-0b14-4ed7-865a-98f03256e74c"],

Cell[TextData[{
 "The \[OpenCurlyDoubleQuote]zero\[CloseCurlyDoubleQuote] references are \
annoying in Mathematica, Julia, and matlab!  I think the easiest fix is to \
view the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", "1"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0272394c-142b-4aa2-a59b-4dcf5b7d9062"],
 " step as part of the initialization.  "
}], "Text",
 CellChangeTimes->{{3.8588535235628843`*^9, 3.8588536448112874`*^9}, {
  3.8588541530994616`*^9, 
  3.8588541545931425`*^9}},ExpressionUUID->"e6bc35b9-2eb8-4fce-bb75-\
1886db2ad7a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LanczosInit", "[", "A_", "]"}], "[", "q1_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "q2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"A", ".", "q1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]1", "=", 
      RowBox[{"q1", ".", "v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", " ", "=", " ", 
      RowBox[{"v", " ", "-", " ", 
       RowBox[{"\[Alpha]1", " ", "q1"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]1", "=", 
      RowBox[{"Norm", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"q2", "=", 
      RowBox[{"v", "/", "\[Beta]1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "q2"}], "}"}], "\[Transpose]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "\[Alpha]1", "}"}], ",", 
         RowBox[{"{", "\[Beta]1", "}"}]}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Lanczos", "[", "A_", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"Q_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]_", ",", "\[Beta]_"}], "}"}]}], "}"}], "]"}], ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "m", ",", "n", ",", "qn", ",", "v", ",", "\[Alpha]n", ",", "\[Beta]n", 
      ",", "qNew"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"qn", "=", 
      RowBox[{"Q", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "n"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"A", ".", "qn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]n", "=", 
      RowBox[{"qn", ".", "v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"v", "-", 
       RowBox[{
        RowBox[{"\[Beta]", "\[LeftDoubleBracket]", 
         RowBox[{"n", "-", "1"}], "\[RightDoubleBracket]"}], " ", 
        RowBox[{"Q", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"n", "-", "1"}]}], "\[RightDoubleBracket]"}]}], "-", 
       RowBox[{"\[Alpha]n", " ", "qn"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]n", "=", 
      RowBox[{"Norm", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"qNew", "=", 
      RowBox[{"v", "/", "\[Beta]n"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"Q", 
            RowBox[{
             RowBox[{"{", "qNew", "}"}], "\[Transpose]"}]}
          }], "\[NoBreak]", ")"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{"\[Alpha]", ",", "\[Alpha]n"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{"\[Beta]", ",", "\[Beta]n"}], "]"}]}], "\[NoBreak]", 
        "}"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8588536525517282`*^9, 3.858853776909675*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"52f2d9cc-fb8c-4c0a-af09-0b5bd5e3a58f"],

Cell["Testing.  This takes slightly more initialization!  ", "Text",
 CellChangeTimes->{{3.858782354648402*^9, 3.858782357178102*^9}, {
  3.8588523618307786`*^9, 
  3.8588523770321503`*^9}},ExpressionUUID->"453186fc-a9c7-41c2-b5ea-\
883eb5c035d0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "=", 
   RowBox[{"A", "+", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{"Normalize", "[", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q1", ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]1", ",", "\[Beta]1"}], "}"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{"LanczosInit", "[", "A", "]"}], "[", "q1", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q", ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}]}], "}"}], "=", 
   RowBox[{"Nest", "[", 
    RowBox[{
     RowBox[{"Lanczos", "[", "A", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Q1", ",", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]1", ",", "\[Beta]1"}], "}"}]}], "}"}], ",", 
     RowBox[{"n", "-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Band", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "]"}], "->", "\[Alpha]"}], ",", 
      RowBox[{
       RowBox[{"Band", "[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}], "]"}], "->", "\[Beta]"}], ",", 
      RowBox[{
       RowBox[{"Band", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "]"}], "->", 
       RowBox[{"Drop", "[", 
        RowBox[{"\[Beta]", ",", 
         RowBox[{"-", "1"}]}], "]"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"H", ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"Map", "[", 
     RowBox[{"Norm", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Q", "\[Transpose]"}], ".", "Q"}], "-", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"n", "+", "1"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"A", ".", 
          RowBox[{"Q", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"1", ";;", "n"}]}], "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{"Q", ".", "H"}]}]}], "}"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.858782359242996*^9, 3.858782655460885*^9}, {
   3.858782694669466*^9, 3.858782844540738*^9}, {3.8587829099782476`*^9, 
   3.85878294583013*^9}, {3.8587830227816586`*^9, 3.8587830878849726`*^9}, 
   3.858783163207555*^9, {3.8587832204891863`*^9, 3.858783263039551*^9}, {
   3.8587834526900473`*^9, 3.858783642115553*^9}, {3.8588521665528564`*^9, 
   3.8588522637240877`*^9}, {3.8588529814525323`*^9, 
   3.8588529816893873`*^9}, {3.858853790538422*^9, 3.8588540840759077`*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"b61d5824-8513-4677-a1d6-6164cca13cd2"],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgA2JWIAaxIeCDPa3oLecOxuc9fG2/Xmey+tucx/Yn6g+s
F+bbRTXzX6f+D+EOf2u/5ndghajoA/vAuiUzJn4usGe7H/no/fy39tVyiWZT
L7yyl8nSFj+6/xHZ9jysElnn/vCWPSzE9KW+61xWfmvP0htecPrdC/vnLzfs
36pzB6d7cJnbtEY4q0T5jX3llPTli9we2jOJtJUenl1h77GZOa3/71v7j0tv
eMQYvbGfWeN862f4M5zuwWV+oyD/Za3YN/Y/Lj+35ep6at/BkO4zeflZ+10L
SzinZT6z/3CEwWrXslf2y2+lhyZefYPTPaSG183b6Wu9PW7Ze683XKic+dQ+
d8ESEakdL3G6h9J0AKMBWSTV8A==
   "], {{0, 0}, {5, 6}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{5.5, 
       FormBox["1", TraditionalForm]}, {4.5, 
       FormBox["2", TraditionalForm]}, {3.5, 
       FormBox["3", TraditionalForm]}, {2.5, 
       FormBox["4", TraditionalForm]}, {1.5, 
       FormBox["5", TraditionalForm]}, {0.5, 
       FormBox["6", TraditionalForm]}}, {{5.5, 
       FormBox["1", TraditionalForm]}, {4.5, 
       FormBox["2", TraditionalForm]}, {3.5, 
       FormBox["3", TraditionalForm]}, {2.5, 
       FormBox["4", TraditionalForm]}, {1.5, 
       FormBox["5", TraditionalForm]}, {0.5, 
       FormBox["6", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]},
  PlotLabel->FormBox[
    RowBox[{"{", 
      RowBox[{"7.905799414989526`*^-16", ",", "4.805479841058825`*^-16"}], 
      "}"}], TraditionalForm]]], "Output",
 CellChangeTimes->{{3.8588539006345363`*^9, 3.858853920243265*^9}, {
  3.8588539923037915`*^9, 3.858854004991149*^9}, {3.858854044379247*^9, 
  3.8588540847494087`*^9}},
 CellLabel->
  "Out[282]=",ExpressionUUID->"5b0e25d3-3c2f-44a9-b27d-37a110ce2ac2"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1268, 965},
WindowMargins->{{1604, Automatic}, {-142, Automatic}},
TaggingRules->Association[
 "PresenterSettings" -> Association["Dialogs" -> {}], "TryRealOnly" -> False],
Magnification:>1.5 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Aqua.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"35c69ee6-1e00-48e3-b52a-dfccec1a206e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 742, 12, 184, "Title",ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],
Cell[1325, 36, 3360, 81, 353, "Text",ExpressionUUID->"19c34891-b4a5-4bb2-9167-f8ac0b4049d9"],
Cell[4688, 119, 3275, 84, 409, "Input",ExpressionUUID->"b267116a-5d29-48b4-b646-4a795f6fcaa2",
 InitializationCell->True],
Cell[7966, 205, 271, 6, 50, "Text",ExpressionUUID->"435fdbdf-1deb-42e6-9789-c9418d7804ac"],
Cell[CellGroupData[{
Cell[8262, 215, 2425, 76, 271, "Input",ExpressionUUID->"28cc6474-5dba-4e82-8bd5-5dc18691de07"],
Cell[10690, 293, 2710, 59, 673, "Output",ExpressionUUID->"c237c187-fb66-443d-b853-5e6a8a6cd84a"]
}, Open  ]],
Cell[13415, 355, 3619, 111, 189, "Text",ExpressionUUID->"0e04644a-c9bf-4e39-b199-72604c38e6f9"],
Cell[17037, 468, 317, 6, 50, "Text",ExpressionUUID->"1243cfa9-51ec-48bb-8ad8-eafb9c5c705f"],
Cell[17357, 476, 3032, 81, 528, "Input",ExpressionUUID->"4cdbf6aa-0b14-4ed7-865a-98f03256e74c"],
Cell[20392, 559, 579, 14, 83, "Text",ExpressionUUID->"e6bc35b9-2eb8-4fce-bb75-1886db2ad7a3"],
Cell[20974, 575, 3422, 89, 552, "Input",ExpressionUUID->"52f2d9cc-fb8c-4c0a-af09-0b5bd5e3a58f",
 InitializationCell->True],
Cell[24399, 666, 247, 4, 50, "Text",ExpressionUUID->"453186fc-a9c7-41c2-b5ea-883eb5c035d0"],
Cell[CellGroupData[{
Cell[24671, 674, 3365, 97, 300, "Input",ExpressionUUID->"b61d5824-8513-4677-a1d6-6164cca13cd2"],
Cell[28039, 773, 2548, 56, 673, "Output",ExpressionUUID->"5b0e25d3-3c2f-44a9-b27d-37a110ce2ac2"]
}, Open  ]]
}, Open  ]]
}
]
*)

