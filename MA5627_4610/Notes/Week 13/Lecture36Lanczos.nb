(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13791,        367]
NotebookOptionsPosition[     12636,        338]
NotebookOutlinePosition[     13270,        359]
CellTagsIndexPosition[     13227,        356]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["36: Lanczos Iteration", "Title",
 CellChangeTimes->CompressedData["
1:eJwdzEFIk2EAh/EvjVwiQUFNYaLLJSGuww7NhJCtKQ53iLEwOoyQjHZoiUrq
cpKR0WWyWdNYUmu0Ma3M1cCDhN8cfs2a6FCs0Ax16DY3bFvLUNDe/3t4+N0e
YcMddWMWwzAiEpRnyZlpd1w2ueQ4BG28sOI3scXMq4WmfUluksi1v8iDMVWw
LEV0y9aoKpfjZZrYtzVih8faik8LhuIyaTpJ7cm/8LGQ2MQFqE/+KNebiaPV
XBieWR6M2og3jr6OQflVD/uceP/eng96/B3lb4k8S9U5GGQeNfuIoiv8Vtj7
dJyFnT8D1A9Ww8gicfar7T3kBUMTUK1sYaE3al6F/tRmGB6evxuFyhOmGNRN
hZzfiJKyJRfs4qr8UPDMQF2umP4MA/36ABRta+bhqXe3FmDdRfEPeCRpoSYE
xl9wI+KhaoxfwlC7cy0CjbruOKy4mUzQf0acgnN8HXUlY/0LhWLpDvx3O/sA
Xm8dyP5OLHjTnQNLvY150FdYcxxODNefhNqZywWw74GT6t6/VAR3h15RFVNN
JZATnhdBr117Fj6sDFEFJWw5/NSgl8Ax+2A0h43LHI8nqf8BeWFUlw==
  "],ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],

Cell[TextData[{
 "Arnoldi and all sorts of other stuff gets simpler for symmetric matrices. \
As you would expect Upper Hessenberg matrices become tridiagonal.  One other \
thing that happens is the general Arnoldi Iteration gets called Lanczos in \
the special symmetric case. Just as a reminder the Krylov space is \t\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[ScriptCapitalK]", "n"], "(", 
     RowBox[{"A", ",", "b"}], ")"}], ":=", 
    RowBox[{"span", "(", 
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{"A", ".", "b"}], ",", 
       RowBox[{
        SuperscriptBox["A", "2"], ".", "b"}], ",", "\[Ellipsis]", ",", 
       RowBox[{
        SuperscriptBox["A", 
         RowBox[{"n", "-", "1"}]], ".", "b"}]}], "}"}], ")"}]}], 
   TraditionalForm]],ExpressionUUID->"c91ce224-9c68-4acb-95d9-c3c5a261b80f"],
 "\nand Arnoldi iteratively computes a nested sequence of orthonormal basis \
for the Krylov space (represented by orthogonal matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Q", "n"], "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     RowBox[{"m", "\[Times]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "7df52d0e-632c-46e4-af4f-bf41327060c7"],
 ") and a rectangular Upper Hessenberg matrices ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["H", "n"], "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}], "\[Times]", "n"}]]}], 
   TraditionalForm]],ExpressionUUID->"cbe7a7ff-b185-46ba-a9cf-365b9e6c061c"],
 " which represents the action of A on these basis through\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", ".", 
     SubscriptBox["Q", "n"]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["Q", 
       RowBox[{"n", "+", "1"}]], ".", 
      SubscriptBox["H", "n"]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["Q", "n"], ".", 
       RowBox[{
        SubscriptBox["H", "n"], "[", 
        RowBox[{
         RowBox[{"1", ":", "n"}], ",", 
         RowBox[{"1", ":", "n"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{
        SubscriptBox["H", "n"], "[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ",", "n"}], "]"}], " ", 
       SubscriptBox["q", 
        RowBox[{"n", "+", "1"}]]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "3da0ee12-817f-43a6-83ed-0b3fdb37f664"],
 ". \nThe question is what simplifies when A is real symmetric.  We are going \
to look at the Arnoldi code and work out what can be tidied up. "
}], "Text",
 CellChangeTimes->{{3.8470540488466187`*^9, 3.847054299041844*^9}, 
   3.847054620646575*^9, {3.84705469788529*^9, 3.8470547053171043`*^9}, {
   3.84705474014857*^9, 3.847054741548669*^9}, {3.84705479048367*^9, 
   3.8470548010520067`*^9}, {3.847097256754077*^9, 3.8470972849056597`*^9}, {
   3.847140756236305*^9, 3.847140780380496*^9}, {3.847141112793906*^9, 
   3.847141123081209*^9}, {3.847141212815769*^9, 3.8471414441116858`*^9}, {
   3.847141743880835*^9, 3.847141771661133*^9}, {3.847142998261689*^9, 
   3.847143060799942*^9}, {3.8587758902452593`*^9, 3.858776033873631*^9}, {
   3.8587760880076685`*^9, 3.85877631985137*^9}, {3.8587763658496523`*^9, 
   3.8587763898274508`*^9}, {3.85877663748153*^9, 
   3.8587766485889173`*^9}},ExpressionUUID->"19c34891-b4a5-4bb2-9167-\
f8ac0b4049d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Arnoldi", "[", "A_", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"Q_", ",", "H_"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "n", ",", "HNew", ",", "w", ",", "h", ",", "q"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "=", 
      RowBox[{"Dimensions", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"HNew", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"HNew", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"1", ";;", "n"}], ",", 
        RowBox[{"1", ";;", 
         RowBox[{"n", "-", "1"}]}]}], "\[RightDoubleBracket]"}], "=", "H"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"A", ".", 
       RowBox[{"Q", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "n"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"q", "=", 
         RowBox[{"Q", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"HNew", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", "n"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"q", ".", "w"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"w", "=", 
         RowBox[{"w", "-", 
          RowBox[{
           RowBox[{"HNew", "\[LeftDoubleBracket]", 
            RowBox[{"k", ",", "n"}], "\[RightDoubleBracket]"}], " ", 
           "q"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HNew", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"n", "+", "1"}], ",", "n"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Norm", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"w", "/", 
       RowBox[{"HNew", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ",", "n"}], "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"Q", 
            RowBox[{
             RowBox[{"{", "w", "}"}], "\[Transpose]"}]}
          }], "\[NoBreak]", ")"}], "]"}], ",", "HNew"}], "\[NoBreak]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQnbytJit57xtHk1tBZSB61m21KhCtVPNzG4i+9Sjy
LIgO6EsA00KNbDdBtAHvt8cg+pxh3FcQfbjw4E8QvadtN28KkHZZ3CUJog+U
3JYH0R89egxAtNf/XSYgOtdDxAxEr3BbZgeiraaIuoFoue9VXiD6gedDML1p
1eQSEN1Vz90JogWeh2wC0ZW+tdtA9NGT7r/B5jBv+guixeb31acD6e7DBo0g
mudu6EYQfcIhYTuILlfM3g2iT5X7nwXRJRWZF0H0jIp7l0D0xrcLb4DoMpEr
t0B019mlL0G0ZkfBBxCt84T9O4i+tFv1B9jc2sp/ILq/JogjA0gDADiJu8U=

  "],
 CellLabel->"In[1]:=",ExpressionUUID->"b267116a-5d29-48b4-b646-4a795f6fcaa2"],

Cell["\<\
Not surprisingly the Hessenberg matrix becomes tridiagonal.  This is because \
\>", "Text",
 CellChangeTimes->{{3.8587769172069907`*^9, 
  3.85877696217264*^9}},ExpressionUUID->"435fdbdf-1deb-42e6-9789-\
c9418d7804ac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m", "=", "123"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"A", "=", " ", 
   RowBox[{"A", " ", "+", " ", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Normalize", "[", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q0", ",", "H0"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "b", "}"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "}"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q1", ",", "H1"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Arnoldi", "[", "A", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"Q0", ",", "H0"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q2", ",", "H2"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Arnoldi", "[", "A", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"Q1", ",", "H1"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q3", ",", "H3"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Arnoldi", "[", "A", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"Q2", ",", "H2"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Q4", ",", "H4"}], "}"}], "=", 
   RowBox[{
    RowBox[{"Arnoldi", "[", "A", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"Q3", ",", "H3"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", 
  RowBox[{
   RowBox[{"Chop", "[", "H4", "]"}], ",", 
   RowBox[{"ColorRules", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", "->", "LightGreen"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8587766536233735`*^9, 3.8587768996943035`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"28cc6474-5dba-4e82-8bd5-5dc18691de07"],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBWIWIAaxNWP6D33VeGPPAAYf7GF8UsW3d0X1C855bR9m
sueu/NmH9pP/rRDt+VVNsjnP7+57+UPunf28tNXM3+bcs1eYzKD8+VO6/dbV
p0JTPN/Z3yopPP4i4K39o/na2QGOL3GaY7DgrtrbJ2/sFy0KEi1qe2C/f5rU
nAuniu0Nug5eK5R4bD+j3OnO/mMv7Pc0zpmvvOM1Tnv554Wd85B4b596/eK/
xWvv2PMUr01eIxRu35MrK7tp11t70TXnyjeZvrZf46B1/9ixxzjtxeXOXbo5
X6d9f2mfd3LBHOmVb+x/9Z24L8D+Dq7uYZXIOveHt6B80uMLAOko3es=
   "], {{0, 0}, {4, 5}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{4.5, 
       FormBox["1", TraditionalForm]}, {3.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {1.5, 
       FormBox["4", TraditionalForm]}, {0.5, 
       FormBox["5", TraditionalForm]}}, {{4.5, 
       FormBox["1", TraditionalForm]}, {3.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {1.5, 
       FormBox["4", TraditionalForm]}, {0.5, 
       FormBox["5", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultPlotStyle" -> 
    Automatic, "DomainPadding" -> Scaled[0.02], "RangePadding" -> 
    Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.858776818643198*^9, {3.858776848934338*^9, 3.8587769002934885`*^9}},
 CellLabel->"Out[54]=",ExpressionUUID->"0dc23808-7663-4680-9800-c0aef41e78c4"]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1268, 965},
WindowMargins->{{1604, Automatic}, {-142, Automatic}},
TaggingRules->Association[
 "PresenterSettings" -> Association["Dialogs" -> {}], "TryRealOnly" -> False],
Magnification:>1.5 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Aqua.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"35c69ee6-1e00-48e3-b52a-dfccec1a206e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 742, 12, 184, "Title",ExpressionUUID->"bb443c9e-1a1c-437e-b10c-400e63a30bb8"],
Cell[1325, 36, 3360, 81, 353, "Text",ExpressionUUID->"19c34891-b4a5-4bb2-9167-f8ac0b4049d9"],
Cell[4688, 119, 3275, 84, 409, "Input",ExpressionUUID->"b267116a-5d29-48b4-b646-4a795f6fcaa2",
 InitializationCell->True],
Cell[7966, 205, 228, 5, 50, "Text",ExpressionUUID->"435fdbdf-1deb-42e6-9789-c9418d7804ac"],
Cell[CellGroupData[{
Cell[8219, 214, 2283, 73, 271, "Input",ExpressionUUID->"28cc6474-5dba-4e82-8bd5-5dc18691de07"],
Cell[10505, 289, 2103, 45, 673, "Output",ExpressionUUID->"0dc23808-7663-4680-9800-c0aef41e78c4"]
}, Open  ]]
}, Open  ]]
}
]
*)

